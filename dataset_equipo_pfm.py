# -*- coding: utf-8 -*-
"""Dataset Equipo PFM.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1_f19bAH_GKfthL7EheXFXwANKqewus-p
"""

#Librer√≠as

import pandas as pd
import matplotlib.pyplot as plt
from matplotlib.offsetbox import OffsetImage, AnnotationBbox
from PIL import Image

df = pd.read_excel("DatasetEquiposAsobal.xlsx")

df.head()

df.drop('PPP (Posesiones por partido)', inplace=True, axis= 1)

df['Logo'] = df['Equipo'] + '.png'
df.head()

fig, ax = plt.subplots(figsize=(6, 4), dpi=120)
ax.scatter(df['OffRt'], df['DefRt'])

fig, ax = plt.subplots(figsize=(6, 4), dpi=120)
ax.scatter(df['OffRt'], df['DefRt'])
ax.invert_yaxis()

def getImage(path):
    return OffsetImage(plt.imread(path), zoom=.05, alpha = 1)

fig, ax = plt.subplots(figsize=(6, 4), dpi=120)
ax.scatter(df['OffRt'], df['DefRt'], color='blue')
ax.invert_yaxis()

for index, row in df.iterrows():
    ab = AnnotationBbox(getImage(row['Logo']), (row['OffRt'], row['DefRt']), frameon=False)
    ax.add_artist(ab)

#Save image:
#plt.savefig('asobalteams.png')

# Set font and background colour
plt.rcParams.update({'font.family':'Avenir'})
bgcol = '#fafafa'

# Create initial plot
fig, ax = plt.subplots(figsize=(6, 4), dpi=120)
fig.set_facecolor(bgcol)
ax.set_facecolor(bgcol)
ax.scatter(df['OffRt'], df['DefRt'], c=bgcol)
ax.invert_yaxis()

# Change plot spines
ax.spines['right'].set_visible(False)
ax.spines['top'].set_visible(False)
ax.spines['left'].set_color('#ccc8c8')
ax.spines['bottom'].set_color('#ccc8c8')

# Change ticks
plt.tick_params(axis='x', labelsize=12, color='#ccc8c8')
plt.tick_params(axis='y', labelsize=12, color='#ccc8c8')

# Plot badges
def getImage(path):
    return OffsetImage(plt.imread(path), zoom=.05, alpha = 1)

for index, row in df.iterrows():
    ab = AnnotationBbox(getImage(row['Logo']), (row['OffRt'], row['DefRt']), frameon=False)
    ax.add_artist(ab)

# Add average lines
plt.hlines(df['DefRt'].mean(), df['OffRt'].min(), df['OffRt'].max(), color='#c2c1c0')
plt.vlines(df['OffRt'].mean(), df['DefRt'].min(), df['DefRt'].max(), color='#c2c1c0')
plt.xlabel("Rating Ofensivo")
plt.ylabel("Rating Defensivo")

# Text

## Title & comment
fig.text(.15,.98,'Asobal Snapshot',size=20)
fig.text(.15,.93,'Temporada 22/23', size=12)
fig.text(.90,.98,'Fuente: ASOBAL', size=8)
fig.text(.90,.94,'Ratings: Adjustado por 50 posesiones', size=8)


## Info
fig.text(.75,.70,'Buena Defensa / Buen Ataque', size=5)
fig.text(.20,.70,'Buena Defensa / Mal Ataque', size=5)
fig.text(.75,.25,'Mala Defensa / Buen Ataque', size=5)
fig.text(.20,.25,'Mala Defensa / Mal Ataque', size=5)


## Avg line explanation
fig.text(.03,.14,'', size=9, color='#0D0103',rotation=90)
fig.text(.12,0.02,'', size=9, color='#0D0103')

## Axes titles
fig.text(.77,.365,'Avg. Defense', size=6, color='#0D0103')
fig.text(.515,.72,'Avg. Offense', size=6, color='#0D0103',rotation=90)

## Save plot
plt.savefig('asobal2223.png', dpi=1200, bbox_inches = "tight")